import{r as e,j as s}from"./framerMotion-CogqvMXS.js";import{b as a}from"./api-B_NPPa4_.js";import"./vendor-BI3NJeJA.js";const t=()=>{const[t,r]=e.useState([]),[n,i]=e.useState(!0),[c,l]=e.useState(""),[d,o]=e.useState("all"),[m,p]=e.useState({}),[h,j]=e.useState(null);e.useEffect(()=>{x(),N()},[d]);const x=async()=>{try{const e="all"!==d?{status:d}:{},s=await a.getReports(e);Array.isArray(s)?r(s):(r([]),l("Invalid data format received from server"))}catch(e){l(`Error fetching reports: ${e.message||"Unknown error"}`),r([])}finally{i(!1)}},N=async()=>{try{const e=await a.getReportStats();p(e)}catch(e){}},v=async(e,s,n="")=>{try{const i="approved"===s?"resolved":"rejected"===s?"dismissed":s;await a.updateReportStatus(e,i,n),r(t.map(a=>a._id===e?{...a,status:s,adminNotes:n,reviewedAt:new Date}:a)),j(null),N()}catch(i){l(i.message||"Error updating report")}},u=e=>{switch(e){case"pending":return"#ffa726";case"approved":return"#66bb6a";case"rejected":return"#ef5350";default:return"#757575"}},g=e=>{switch(e){case"inappropriate":return"âš ï¸";case"spam":return"ðŸš«";case"copyright":return"Â©ï¸";case"harassment":return"ðŸ›¡ï¸";case"other":return"â“";default:return"ðŸ“"}};return n?s.jsx("div",{className:"admin-panel",children:s.jsx("div",{className:"loading",children:"Loading admin panel..."})}):s.jsxs("div",{className:"admin-panel",children:[s.jsxs("div",{className:"admin-header",children:[s.jsx("h1",{children:"Admin Panel"}),s.jsxs("div",{className:"stats-bar",children:[s.jsxs("div",{className:"stat-item",children:[s.jsx("span",{className:"stat-number",children:m.total||0}),s.jsx("span",{className:"stat-label",children:"Total Reports"})]}),s.jsxs("div",{className:"stat-item",children:[s.jsx("span",{className:"stat-number",children:m.pending||0}),s.jsx("span",{className:"stat-label",children:"Pending"})]}),s.jsxs("div",{className:"stat-item",children:[s.jsx("span",{className:"stat-number",children:m.approved||0}),s.jsx("span",{className:"stat-label",children:"Approved"})]}),s.jsxs("div",{className:"stat-item",children:[s.jsx("span",{className:"stat-number",children:m.rejected||0}),s.jsx("span",{className:"stat-label",children:"Rejected"})]})]})]}),c&&s.jsx("div",{className:"error-message",children:c}),s.jsx("div",{className:"admin-controls",children:s.jsxs("div",{className:"filter-buttons",children:[s.jsx("button",{className:"all"===d?"active":"",onClick:()=>o("all"),children:"All Reports"}),s.jsx("button",{className:"pending"===d?"active":"",onClick:()=>o("pending"),children:"Pending"}),s.jsx("button",{className:"approved"===d?"active":"",onClick:()=>o("approved"),children:"Approved"}),s.jsx("button",{className:"rejected"===d?"active":"",onClick:()=>o("rejected"),children:"Rejected"})]})}),s.jsx("div",{className:"reports-container",children:0===t.length?s.jsx("div",{className:"no-reports",children:"No reports found for the selected filter."}):s.jsx("div",{className:"reports-grid",children:t.map(e=>s.jsxs("div",{className:"report-card",children:[s.jsxs("div",{className:"report-header",children:[s.jsxs("div",{className:"report-type",children:[s.jsx("span",{className:"type-icon",children:g(e.reason)}),s.jsx("span",{className:"type-text",children:e.reason})]}),s.jsx("div",{className:"report-status",style:{backgroundColor:u(e.status)},children:e.status})]}),s.jsxs("div",{className:"report-content",children:[s.jsxs("div",{className:"report-target",children:[s.jsx("strong",{children:"Target:"})," ",e.targetType,e.targetArtist&&` by ${e.targetArtist.name}`]}),s.jsxs("div",{className:"report-description",children:[s.jsx("strong",{children:"Description:"}),s.jsx("p",{children:e.description})]}),s.jsxs("div",{className:"report-reporter",children:[s.jsx("strong",{children:"Reported by:"})," ",e.reportedBy.name]}),s.jsxs("div",{className:"report-date",children:[s.jsx("strong",{children:"Submitted:"})," ",new Date(e.createdAt).toLocaleDateString()]}),e.adminNotes&&s.jsxs("div",{className:"admin-notes",children:[s.jsx("strong",{children:"Admin Notes:"}),s.jsx("p",{children:e.adminNotes})]})]}),"pending"===e.status&&s.jsx("div",{className:"report-actions",children:s.jsx("button",{className:"approve-btn",onClick:()=>j(e),children:"Review"})})]},e._id))})}),h&&s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"review-modal",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Review Report"}),s.jsx("button",{className:"close-btn",onClick:()=>j(null),children:"Ã—"})]}),s.jsxs("div",{className:"modal-content",children:[s.jsxs("div",{className:"report-details",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Type:"})," ",h.reason]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Target:"})," ",h.targetType]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Description:"})," ",h.description]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Reported by:"})," ",h.reportedBy.name]})]}),s.jsxs("div",{className:"admin-notes-input",children:[s.jsx("label",{htmlFor:"adminNotes",children:"Admin Notes (optional):"}),s.jsx("textarea",{id:"adminNotes",placeholder:"Add notes about your decision...",rows:"4"})]}),s.jsxs("div",{className:"modal-actions",children:[s.jsx("button",{className:"approve-btn",onClick:()=>{const e=document.getElementById("adminNotes").value;v(h._id,"approved",e)},children:"Approve Report"}),s.jsx("button",{className:"reject-btn",onClick:()=>{const e=document.getElementById("adminNotes").value;v(h._id,"rejected",e)},children:"Reject Report"}),s.jsx("button",{className:"cancel-btn",onClick:()=>j(null),children:"Cancel"})]})]})]})})]})};export{t as default};
