import{j as e,A as r,m as t}from"./chunk-DrBkpLm2.js";import{r as a,L as i}from"./chunk-CMRBzt0a.js";import{n as o,o as l,s,g as n,t as c,f as d,u as m}from"./chunk-Ca7r8q3n.js";import{y as p}from"./chunk-BWoFSTeq.js";import{L as h}from"./chunk-i2nP3W7I.js";import{a as u}from"./chunk-Bt6U1h1N.js";const b=new class{constructor(){this.events={}}emit(e,r){this.events[e]&&this.events[e].forEach(e=>{try{e(r)}catch(t){}})}on(e,r){return this.events[e]||(this.events[e]=[]),this.events[e].push(r),()=>{this.events[e]=this.events[e].filter(e=>e!==r)}}off(e,r){this.events[e]&&(this.events[e]=this.events[e].filter(e=>e!==r))}removeAllListeners(e){e?delete this.events[e]:this.events={}}},g={CREATED:"artwork:created",UPDATED:"artwork:updated",DELETED:"artwork:deleted",LIKED:"artwork:liked",UNLIKED:"artwork:unliked",BOOKMARKED:"artwork:bookmarked",UNBOOKMARKED:"artwork:unbookmarked",USER_STATS_UPDATED:"user:stats:updated"},y=({isOpen:i,onClose:s,onSubmit:n,editingArtwork:c=null})=>{const[d,m]=a.useState({title:"",description:"",category:"Traditional",imageUrl:"",isPublic:!0}),[p,h]=a.useState(null),[u,b]=a.useState({}),[g,y]=a.useState(!1);a.useEffect(()=>{c&&i?(m({title:c.title||"",description:c.description||"",category:c.category||"Traditional",imageUrl:c.imageUrl||c.image||"",isPublic:void 0===c.isPublic||c.isPublic}),h(c.imageUrl||c.image||null)):!c&&i&&(m({title:"",description:"",category:"Traditional",imageUrl:"",isPublic:!0}),h(null)),b({})},[c,i]);const x=e=>{const{name:r,value:t}=e.target;m(e=>({...e,[r]:t})),u[r]&&b(e=>({...e,[r]:""}))},f=()=>{m({title:"",description:"",category:"Traditional",imageUrl:"",isPublic:!0}),h(null),b({}),s()};return e.jsx(r,{children:i&&e.jsx(t.div,{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:f,children:e.jsxs(t.div,{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",initial:{scale:.8,opacity:0,y:50},animate:{scale:1,opacity:1,y:0},exit:{scale:.8,opacity:0,y:50},transition:{duration:.3},onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-2xl font-bold text-amber-900",children:c?"Edit Artwork":"Contribute Your Art"}),e.jsx("button",{onClick:f,className:"text-gray-500 hover:text-gray-700 transition-colors",children:e.jsx(o,{size:20})})]}),e.jsxs("form",{onSubmit:e=>{e.preventDefault(),(()=>{const e={};return d.title.trim()?d.title.length>50&&(e.title="Title must be 50 characters or less"):e.title="Title is required",d.description.trim()?d.description.length>100&&(e.description="Description must be 100 characters or less"):e.description="Description is required",d.imageUrl||(e.imageUrl="Please upload an image"),b(e),0===Object.keys(e).length})()&&(n(d),m({title:"",description:"",category:"Traditional",imageUrl:"",isPublic:!0}),h(null),b({}))},className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Artwork Image *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:e=>{const r=e.target.files[0];if(r){const e=new FileReader;e.onload=e=>{h(e.target.result),m(r=>({...r,imageUrl:e.target.result}))},e.readAsDataURL(r)}},className:"hidden",id:"image-upload"}),e.jsx("label",{htmlFor:"image-upload",className:"flex flex-col items-center justify-center w-full h-48 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-amber-400 transition-colors",children:p?e.jsx("img",{src:p,alt:"Preview",className:"w-full h-full object-cover rounded-lg"}):e.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[e.jsx(l,{className:"w-10 h-10 mb-3 text-gray-400"}),e.jsxs("p",{className:"mb-2 text-sm text-gray-500",children:[e.jsx("span",{className:"font-semibold",children:"Click to upload"})," or drag and drop"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG, GIF up to 10MB"})]})})]}),u.imageUrl&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.imageUrl})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Title * ",e.jsxs("span",{className:"text-xs text-gray-500",children:["(",d.title.length,"/50)"]})]}),e.jsx("input",{type:"text",name:"title",value:d.title,onChange:x,placeholder:"Enter artwork title...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent",maxLength:"50"}),u.title&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.title})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Description * ",e.jsxs("span",{className:"text-xs text-gray-500",children:["(",d.description.length,"/100)"]})]}),e.jsx("textarea",{name:"description",value:d.description,onChange:x,placeholder:"Describe your artwork...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent resize-none",maxLength:"100"}),u.description&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),e.jsx("select",{name:"category",value:d.category,onChange:x,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent",children:["Traditional","Contemporary","Abstract","Landscape","Digital","Portrait"].map(r=>e.jsx("option",{value:r,children:r},r))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Publication Status"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",name:"isPublic",value:"true",checked:!0===d.isPublic,onChange:()=>m(e=>({...e,isPublic:!0})),className:"sr-only"}),e.jsxs("div",{className:"flex items-center px-4 py-2 rounded-lg border-2 transition-all "+(!0===d.isPublic?"border-green-500 bg-green-50 text-green-700":"border-gray-300 bg-white text-gray-600 hover:border-gray-400"),children:[e.jsx("span",{className:"mr-2",children:"ðŸ“„"}),e.jsx("span",{className:"font-medium",children:"Published"})]})]}),e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",name:"isPublic",value:"false",checked:!1===d.isPublic,onChange:()=>m(e=>({...e,isPublic:!1})),className:"sr-only"}),e.jsxs("div",{className:"flex items-center px-4 py-2 rounded-lg border-2 transition-all "+(!1===d.isPublic?"border-yellow-500 bg-yellow-50 text-yellow-700":"border-gray-300 bg-white text-gray-600 hover:border-gray-400"),children:[e.jsx("span",{className:"mr-2",children:"ðŸ“"}),e.jsx("span",{className:"font-medium",children:"Draft"})]})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:d.isPublic?"Published artworks will be visible to everyone on the Art Wall.":"Draft artworks are only visible to you in your profile."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:f,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-gradient-to-r from-amber-600 to-orange-600 text-white px-4 py-2 rounded-lg font-semibold hover:from-amber-700 hover:to-orange-700 transition-all duration-300 shadow-lg hover:shadow-xl",children:c?"Update Artwork":"Submit Artwork"})]})]})]})})})},x=({isOpen:r,onClose:t,reportType:i,targetId:o,targetName:l})=>{const[s,n]=a.useState(""),[c,d]=a.useState(""),[m,p]=a.useState(!1),h=()=>{n(""),d(""),p(!1),t()};if(!r)return null;const u={artwork:["Inappropriate Content","Copyright Infringement","Offensive Material","Spam or Misleading","Poor Quality","Other"],artist:["Inappropriate Behavior","Fake Profile","Harassment","Spam Content","Impersonation","Other"]}[i]||[];return e.jsx("div",{className:"report-modal-overlay",onClick:h,children:e.jsxs("div",{className:"report-modal-content",onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{className:"report-modal-header",children:[e.jsxs("h2",{children:["Report ","artwork"===i?"Artwork":"Artist"]}),e.jsx("button",{className:"report-modal-close-btn",onClick:h,disabled:m,children:"Ã—"})]}),e.jsxs("div",{className:"report-modal-body",children:[e.jsxs("p",{className:"report-target-info",children:["Reporting: ",e.jsx("strong",{children:l||`${i} #${o}`})]}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),s){p(!0);try{const e=localStorage.getItem("token"),r=await fetch("/api/reports",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e},body:JSON.stringify({reportType:i,targetId:o,reason:s,description:c.trim()})});if(r.ok)alert("Report submitted successfully. Thank you for helping keep our community safe."),h();else{const e=await r.json();alert(e.message||"Failed to submit report. Please try again.")}}catch(r){alert("Failed to submit report. Please try again.")}finally{p(!1)}}else alert("Please select a reason for reporting.")},children:[e.jsxs("div",{className:"report-form-group",children:[e.jsx("label",{children:"Reason for reporting:"}),e.jsx("div",{className:"report-reasons-list",children:u.map(r=>e.jsxs("label",{className:"report-reason-option",children:[e.jsx("input",{type:"radio",name:"reason",value:r,checked:s===r,onChange:e=>n(e.target.value),disabled:m}),e.jsx("span",{children:r})]},r))})]}),e.jsxs("div",{className:"report-form-group",children:[e.jsx("label",{htmlFor:"description",children:"Additional details (optional):"}),e.jsx("textarea",{id:"description",placeholder:"Please provide any additional context or details about this report...",value:c,onChange:e=>d(e.target.value),rows:4,maxLength:1e3,disabled:m}),e.jsxs("small",{className:"char-count",children:[c.length,"/1000 characters"]})]}),e.jsxs("div",{className:"report-modal-actions",children:[e.jsx("button",{type:"button",className:"btn-cancel",onClick:h,disabled:m,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-submit-report",disabled:!s||m,children:m?"Submitting...":"Submit Report"})]})]})]})]})})},f=({artwork:r,index:o,currentUser:l,isBookmarked:b,onLike:g,onBookmark:y,onImageClick:f})=>{const[k,v]=a.useState(!1),[N,w]=a.useState(b||!1),[C,P]=a.useState(!1),[T,A]=a.useState(!1);a.useEffect(()=>{l&&l.likes&&v(l.likes.includes(r.id)),void 0!==b&&w(b)},[l,r.id,b]);const O={initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,scale:.8},transition:{duration:.4,delay:.1*o}};return e.jsxs(e.Fragment,{children:[e.jsxs(t.div,{className:"bg-white/90 backdrop-blur-sm rounded-3xl shadow-lg overflow-hidden hover:shadow-2xl transition-all duration-300 group cursor-pointer",...O,whileHover:{y:-5,scale:1.02},whileTap:{scale:.98},children:[e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx(h,{src:r.imageUrl,alt:r.title,className:"w-full h-64 group-hover:scale-110 transition-transform duration-500 cursor-pointer",aspectRatio:"",placeholder:"ðŸŽ¨",onClick:()=>f&&f(r)}),e.jsx("div",{className:"absolute top-3 left-3",children:e.jsx("span",{className:"bg-amber-600/90 text-white px-3 py-1 rounded-full text-xs font-semibold backdrop-blur-sm",children:r.category})}),e.jsxs("div",{className:"absolute top-3 right-3 flex space-x-2",children:[e.jsx(t.button,{className:"w-10 h-10 rounded-full flex items-center justify-center backdrop-blur-sm bg-white/80 text-gray-600 hover:bg-red-50 hover:text-red-500 transition-all duration-300",onClick:e=>{e.stopPropagation(),l?A(!0):p.error("Please login to report content",{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})},whileHover:{scale:1.1},whileTap:{scale:.9},title:"Report artwork",children:e.jsx(s,{size:14})}),e.jsx(t.button,{className:"w-10 h-10 rounded-full flex items-center justify-center backdrop-blur-sm transition-all duration-300 "+(N?"bg-amber-600 text-white":"bg-white/80 text-amber-600 hover:bg-amber-50"),onClick:()=>{if(!l)return void p.error("Please login or create an account to bookmark artworks",{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0});const e=N;w(!N),u.toggleBookmark(r.id).then(()=>{y(r.id),p.success(e?"Removed from bookmarks":"Added to bookmarks",{position:"top-center",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}).catch(r=>{w(e),p.error("Failed to update bookmark. Please try again.",{position:"top-center",autoClose:3e3})})},whileHover:{scale:1.1},whileTap:{scale:.9},title:N?"Remove from bookmarks":"Add to bookmarks",children:N?e.jsx(n,{size:16}):e.jsx(c,{size:16})}),e.jsx(t.button,{className:"w-10 h-10 rounded-full flex items-center justify-center backdrop-blur-sm transition-all duration-300 "+(k?"bg-red-500 text-white":"bg-white/80 text-red-500 hover:bg-red-50"),onClick:()=>{if(!l)return void p.error("Please login or create an account to like artworks",{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0});const e=k;v(!k),u.toggleLike(r.id).then(()=>g(r.id)).catch(r=>{v(e),p.error("Failed to update like. Please try again.",{position:"top-center",autoClose:3e3})})},whileHover:{scale:1.1},whileTap:{scale:.9},title:k?"Unlike":"Like",children:k?e.jsx(d,{size:16}):e.jsx(m,{size:16})})]})]}),e.jsxs("div",{className:"p-6 flex flex-col space-y-4",children:[e.jsx(t.h3,{className:"text-xl font-bold text-amber-900 line-clamp-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1*o+.2},children:r.title}),e.jsx(t.p,{className:"text-sm text-amber-700 leading-relaxed line-clamp-3 flex-grow",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1*o+.3},children:r.description}),e.jsxs(t.div,{className:"flex items-center justify-between pt-4 border-t border-amber-100",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1*o+.4},children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-amber-700",children:"By: "}),e.jsx(i,{to:(()=>{const e=r.userId||r.artistId;return e?"/artist/"+e:"#"})(),className:"font-semibold text-amber-800 hover:text-amber-600 hover:underline transition-colors cursor-pointer",onClick:e=>e.stopPropagation(),children:r.artist})]}),e.jsx("span",{className:"text-xs text-gray-500",children:(D=r.createdAt,new Date(D).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-1 text-red-500",children:[e.jsx(d,{size:14}),e.jsx("span",{className:"text-sm font-medium",children:r.likes})]}),e.jsxs("div",{className:"flex items-center space-x-1 text-amber-600",children:[e.jsx(n,{size:14}),e.jsx("span",{className:"text-sm font-medium",children:r.bookmarks||0})]})]})]})]})]}),e.jsx(x,{isOpen:T,onClose:()=>A(!1),reportType:"artwork",reportedItemId:r.id,reportedItemTitle:r.title})]});var D};export{g as A,y as C,f as a,b as g};
